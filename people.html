<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-TDC01ELJLN"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-TDC01ELJLN');
        </script>
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <script src="js/jquery.min.js"></script>
        <script src="js/popper.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/underscore-min.js"></script>
        <script src="js/fa-all.js" data-auto-replace-svg="nest"></script>

        <link type="text/css" rel="stylesheet" href="css/custom.css" />
        <link type="text/css" rel="stylesheet" href="css/hover-min.css" />
        <link type="text/css" rel="stylesheet" href="css/academicons.min.css" />

        <title>VRL Lab Members</title>

        <script type="text/javascript">

            function draw_note(profile){
                divStr = '<div class="card" style="width: 12rem; margin-left:1em;" ><img class="card-img-top" src="data/people/' + profile['img'] + '"> <div class="card-body">';

                divStr += '<a data-toggle="modal" style="width:100%; color:#002776; margin-top:5px; text-align:center;" data-target="#'+ profile['id'] +'">' + profile['name'] + '</a>';

                divStr += '<div class="modal fade" id="' + profile['id']+ '" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="exampleModalLongTitle">' + profile['name'] + '</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div> <div class="modal-body"><b>Biography</b><p class="text-justify">' + profile['bio'] + '</p>';

                if (profile['education'].length > 0){
                    divStr += '<b>Education</b><br>';
                    for (var t=0; t < profile['education'].length; t++) {
                        divStr += '<small><i class="fas fa-graduation-cap"></i> ' + profile['education'][t] + '</small><br>';
                    }
                }

                divStr += "<br><div align='center'>" + get_link_html(profile) + "</div>";

                divStr += '</div></div></div></div>';

                divStr += '</div></div>';
                return divStr;
            }

            function get_link_html(profile){
                divStr = '';
                if('email' in profile['links']) {
                    divStr += '<a href="mailto:' + profile['links']['email'] + '" target="_blank" style="margin-right:5px;"><i class="fas fa-envelope fa-2x"></i></a>'
                }

                if('website' in profile['links']) {
                    divStr += '<a href="' + profile['links']['website'] + '" target="_blank" style="margin-right:5px;"><i class="fas fa-home fa-2x"></i></a>'
                }

                if('scholar' in profile['links']) {
                    divStr += '<a href="' + profile['links']['scholar'] + '" target="_blank" style="margin-right:5px;"><i class="ai ai-google-scholar ai-2x"></i></a>'
                }

                if('orcid' in profile['links']) {
                    divStr += '<a href="' + profile['links']['orcid'] + '" target="_blank" style="margin-right:5px;"><i class="ai ai-orcid ai-2x"></i></a>'
                }

                if('twitter' in profile['links']) {
                    divStr += '<a href="' + profile['links']['twitter'] + '" target="_blank" style="margin-right:5px;"><i class="fab fa-twitter fa-2x"></i></a>'
                }

                if('linkedin' in profile['links']) {
                    divStr += '<a href="' + profile['links']['linkedin'] + '" target="_blank" style="margin-right:5px;"><i class="fab fa-linkedin fa-2x"></i></a>'
                }

                if('github' in profile['links']) {
                    divStr += '<a href="' + profile['links']['github'] + '" target="_blank" style="margin-right:5px;"><i class="fab fa-github fa-2x"></i></a>'
                }
                return divStr
            }

            function draw_card(profile){
                divStr = '<div class="card" style="width: 18rem; margin-left:1em;"><img class="card-img-top" src="data/people/' + profile['img'] + '" alt="Card image cap"> <div class="card-body">';
                divStr += '<h5 class="card-title">' + profile['name'] + '</h5>';
                divStr += '<p class="card-text">' + profile['about'] + '</p>';
            
                divStr += get_link_html(profile);

                divStr += '<button type="button" class="btn btn-outline-secondary btn-sm" data-toggle="modal" style="width:100%; color:#002776; margin-top:5px;" data-target="#'+ profile['id'] +'"><i class="fas fa-expand-arrows-alt"></i> More details</button>';

                divStr += '<div class="modal fade" id="' + profile['id']+ '" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="exampleModalLongTitle">' + profile['name'] + '</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div> <div class="modal-body"><b>Biography</b><p class="text-justify">' + profile['bio'] + '</p>';

                if (profile['education'].length > 0){
                    divStr += '<b>Education</b><br>';
                    for (var t=0; t < profile['education'].length; t++) {
                        divStr += '<small><i class="fas fa-graduation-cap"></i> ' + profile['education'][t] + '</small><br>';
                    }
                }

                divStr += "<br><div align='center'>" + get_link_html(profile) + "</div>";

                divStr += '</div></div></div></div>';

                divStr += '</div></div>';
                return divStr;
            }

            function prepare_user_cards(profiles){
                console.log(profiles);
                var typeRank = ['PI','PhD',"Master's",'Undergraduate','Collaborator','Alumni','Intern'];
                console.log(typeRank);

                var mstr = '';
                //mstr += '<div class="card-columns">';
                for (var t=0; t < typeRank.length; t++) {
                    console.log(typeRank[t]);
                    plist = _.filter(profiles, function(p){ return p['role'] == typeRank[t]; });
                    plist = _.sortBy(plist, function(p){ return p['name']; });
                    console.log(plist);

                    if(plist.length > 0){
                        var extension = '';
                        if (['PhD',"Master's",'Undergraduate'].includes(typeRank[t])){
                            extension = ' students';
                        }
                        if (typeRank[t] == 'Collaborator'){
                            extension = 's';
                        }
                        if (typeRank[t] == 'Alumni'){
                            extension = ' and past collaborators';
                        }
                        if (typeRank[t] == 'Intern'){
                            extension = 's';
                        }

                        
                        mstr += '<h3>' + typeRank[t] + extension + '</h3><div class="card-columns">';
                        //mstr += '<div class="card-columns">';
                        for (var i=0; i<plist.length; i++){
                            if (typeRank[t] !== 'Alumni'){
                                mstr += draw_card(plist[i]);
                            }else{
                                mstr += draw_note(plist[i]);
                            }
                        }
                        mstr += '</div>';
                    }
                }
                $('#member-container').append(mstr);
            }

            $(document).ready(function () {
                $('#header-container').load('template_header.html');
                $('#footer-container').load('template_footer.html');

                $.getJSON('data/people/people.json',
                    function (json) {
                        prepare_user_cards(json);
                });
            });
        </script>

    </head>

    <body>
        <div id="header-container"></div>
        <div class="jumbotron" style="background-image: url(img/bg-people.jpeg);"></div>

        <div class="container">
            <div class="row">
                <div class="alert alert-primary" role="alert">
                    <i class="fas fa-puzzle-piece"></i> We are always looking for highly motivated students to join our group. Write me an e-mail if you are interested.
                </div>
            </div>
            <div class="row">
                <div id="member-container"></div>
            </div>
            <div class="row" class="margin-top:50px;"></div>
        </div>
        <br>
        <div id="footer-container"></div>
    </body>

</html>